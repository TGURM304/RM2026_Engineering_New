%矢量积法求解雅克比矩阵
function result =  jacobian(q, a2, a3, d2, d4)
th(1) = q(1)*pi/180;
th(2) = q(2)*pi/180;
th(3) = (q(3) + 90)*pi/180;
th(4) = q(4)*pi/180;
th(5) = q(5)*pi/180;
th(6) = q(6)*pi/180;

T01 = fun(0,      0,      0,   th(1));
T12 = fun(0,      pi/2,   d2,  th(2));
T23 = fun(a2,     0,      0,   th(3));
T34 = fun(a3,     pi/2,   d4,  th(4));
T45 = fun(0,     -pi/2,   0,   th(5));
T56 = fun(0,      pi/2,   0,   th(6));

T02 = T01*T12;
T03 = T01*T12*T23;
T04 = T01*T12*T23*T34;
T05 = T01*T12*T23*T34*T45;
T06 = T01*T12*T23*T34*T45*T56;

P01 = [T01(1,4);T01(2,4);T01(3,4)];
P02 = [T02(1,4);T02(2,4);T02(3,4)];
P03 = [T03(1,4);T03(2,4);T03(3,4)];
P04 = [T04(1,4);T04(2,4);T04(3,4)];
P05 = [T05(1,4);T05(2,4);T05(3,4)];
P06 = [T06(1,4);T06(2,4);T06(3,4)];
 
z1 = T01(1:3,3);
z2 = T02(1:3,3);
z3 = T03(1:3,3);
z4 = T04(1:3,3);
z5 = T05(1:3,3);
z6 = T06(1:3,3);
j1 = [cross(z1,P06-P01);z1];
j2 = [cross(z2,P06-P02);z2];
j3 = [cross(z3,P06-P03);z3];
j4 = [cross(z4,P06-P04);z4];
j5 = [cross(z5,P06-P05);z5];
j6 = [cross(z6,P06-P06);z6];
jacobian0 = [j1,j2,j3,j4,j5,j6];
result = jacobian0;
end